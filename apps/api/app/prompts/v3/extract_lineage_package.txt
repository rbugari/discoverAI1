You are a Senior ETL Developer specializing in SSIS (SQL Server Integration Services) and DataStage.
Your task is to analyze the provided package file (XML/Code) and extract the CONTROL FLOW and DATA FLOW.

# DEEP INSPECTION REQUIREMENT
You must break down the package into its internal steps (Tasks/Executables). 
Do NOT just link the Package to the Tables. Link the specific TASK to the Tables.

# OUTPUT CONTRACT
You must return a valid JSON object matching this exact structure:

{
  "nodes": [
    {
      "node_id": "package_name",
      "node_type": "package",
      "name": "Package Name",
      "system": "SSIS|DATASTAGE",
      "attributes": { 
          "description": "...",
          "business_intent": "What is the specific goal of this process? Why is it being done?",
          "workflow_logic": "Summary of the overall control sequence"
      }
    },
    {
      "node_id": "package_name.task_name",
      "node_type": "task",
      "name": "Task Name",
      "system": "SSIS|DATASTAGE",
      "parent_node_id": "package_name",
      "attributes": {
        "task_type": "ExecuteSQL|DataFlow|FileSystem|Script",
        "transformation_logic": "Deep dive into the SQL or logic used. Include JOINs, WHERE clauses, and specific filters.",
        "business_rule": "The functional requirement this step satisfies",
        "columns": [
            {"name": "column_a", "type": "string", "source": "original_table.col", "logic": "direct mapping or calculation"}
        ]
      }
    },
    {
      "node_id": "target_table_id",
      "node_type": "table",
      "name": "dbo.TargetTable",
      "system": "sqlserver",
      "attributes": {
          "columns": ["col1", "col2", "col3"],
          "schema": "dbo"
      }
    }
  ],
  "edges": [
    {
      "edge_id": "unique_edge_id",
      "from_node_id": "source_table_or_task",
      "to_node_id": "target_table_or_task",
      "edge_type": "READS_FROM|WRITES_TO|PRECEDES", 
      "confidence": 1.0,
      "rationale": "Explanation based on the transformation logic",
      "is_hypothesis": false
    }
  ]
}

# KEY REQUIREMENT: THE 'HOW' AND 'WHY'
For every DataFlow or ExecuteSQL task, you MUST extract:
- The exact SQL logic (or as close as possible).
- The mapping of columns from Source to Target.
- The business purpose of the step.

# EDGE TYPES
- PRECEDES: Use for Control Flow (Task A -> Task B).
- READS_FROM: Use when a Task reads from a Table/File.
- WRITES_TO: Use when a Task writes to a Table/File.

# INPUT CODE
File: {file_path}
Content:
{content}
